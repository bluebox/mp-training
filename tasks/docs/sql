  --create table Department_Table (dept_id int primary key , dept_name varchar);
--create table Insurance_Table (insurance_id int primary key , isurance_name varchar );
--create table  Office_Table(office_id int primary key, office_name varchar , place varchar);
--create table Employee_Info_Table(id int primary key , DOJ date , salary varchar );
--create table  Employee_Table( emp_id int primary key, name varchar, immediate_head_id int ,dept_id int , insurance_id int ,   employee_info_id int , foreign key (dept_id) references Department_Table(dept_id), foreign key (insurance_id) references Insurance_Table(insurance_id),foreign key (employee_info_id) references Employee_Info_Table(id));
--create table  Employee_Office_Table(id int primary key , emp_id int , office_id int ,foreign key (emp_id) references Employee_Table(emp_id),foreign key (office_id) references Office_Table(office_id));




INSERT INTO Department_Table (dept_id,dept_name) VALUES ('01', 'pharma'),('02', 'optival'), ('03', 'custom furnish'),('04', 'it');

INSERT INTO Office_Table  VALUES ('01', 'pharma', 'kukatplally'),('02', 'optival', 'hitechcity'),('03', 'custom furnish', 'madhapur'),('04', 'it', 'balnagar');

-insert into Insurance_Table values(21,"lic"),(22,"medplus"),(23,"sbi");

insert into  Employee_Info_Table values (102,"13-6-2022",50000), (103,"7-7-2022",40000);

insert  into Employee_Table values (200,"samba",251,2,21,100), (201,"srikar",252,2,22,100), (203,"sahithi",253,2,21,101), (204,"bhargavi",252,2,23,100), (205,"harsha",251,2,21,100), (252,"maniteja",null,2,21,102), (251,"vaibhav",null,2,22,102);

insert into Employee_Office_Table values (2,200,2),(1,204,1),(3,203,2);
1.
select Employee_Table.name,Department_Table.dept_name, Insurance_table.insurance_name 





from Employee_Table  join Department_Table 
on Employee_Table.dept_id=Department_Table.dept_id  join Insurance_table on 
Employee_Table.insurance_id=Insurance_table.Insurance_id;
2.select Employee_Table.emp_id from Employee_Table join Employee_Office_Table as h on Employee_Table.emp_id=h.emp_id join Office_Table as g on h.office_id=g.office_id where g.place="hitechcity";

3.select count(s.name),g.place from Employee_Table as s join Employee_Office_Table as h on s.emp_id=h.emp_id join Office_Table as g on h.office_id=g.office_id group by g.place;

4.select e.name,i.insurance_name,t.salary from Employee_Table e join Insurance_table i on e.insurance_id=i.insurance_id join Employee_Info_Table t on e.employee_info=t.id ORDER BY t.salary desc LIMIT 3,1; 

5.select 
avg(i.salary) as avg,d.dept_name 
from 
Department_Table d join Employee_Table e on d.dept_id=e.dept_id join Employee_Info_Table i on i.id=e.employee_info join Employee_Office_Table o on o.emp_id=e.emp_id join Office_Table g on g.office_id=o.office_id
group by d.dept_id 
having g.place ="hitechcity"; 

6.select sum(i.salary) from Employee_Info_Table i join Employee_Table j on i.id=j.employee_info join Employee_Office_Table k on j.emp_id=k.emp_id join Office_Table l on l.office_id=k.office_id where l.place="hitechcity" and i.DOJ>"2022-01-02";

7.select i.name,j.salary,k.dept_name from Employee_Table i join Employee_Info_Table j on i.employee_info=j.id join Department_Table k on i.dept_id=k.dept_id join Insurance_table l on i.insurance_id=l.insurance_id join Office_Table m on m.place="hitechcity" where j.DOJ>"2022-02-20" and j.salary>20000 and (l.insurance_name="lic" or l.insurance_name="anand") 

8.select j.name,i.name as head from Employee_Table i join Employee_Table j on i.emp_id=j.immediate_head_id;

9.select k.name,l.dept_name,i.name as head,j.dept_name from Employee_Table i join Department_Table j on i.dept_id = j.dept_id join Employee_Table k on i.emp_id=k.immediate_head_id join Department_Table l on k.dept_id=l.dept_id;

10.select t1.name from employee_table t1 join employee_table t2 on t1.immediate_head_id = t2.emp_id join Employee_office_table t3 on t2.emp_id=t3.emp_id join office_table t4 on t4.office_id = t3.office_id 
join Employee_Info_Table  t5 on t5.id= t2.employee_info_id join Employee_Info_Table t6 on t6.id=t1.employee_info_id where t4.place="madhapur" and t5.salary>2*t6.salary ;






















create table  Head_of_department(hod_id int primary key ,hod_name varchar,hod_salary varchar);

create table Department(dept_id int primary key ,dept_name varchar,hod_id int,branch varchar ,foreign key(hod_id) references Head_of_department(hod_id));

create table Exam_branch(exam_id int primary key, fee_status varchar ,due_exams int ,completed_exams int);

create table Student (id int primary key,name varchar, currentyear int,dept_id int,exam_id int ,foreign key(dept_id) references Department(dept_id), foreign key (exam_id) references Exam_branch(exam_id));


insert into Department values (200,"ece",100,"1"),(201,"cse",101,"1"),(203,"it",103,"1"),(204,"mech",104,"2"),(205,"eee",105,"2");
insert into Head_of_department values (100,"ravi",60000),(101,"raju",70000),(103,"hari",50000),(104,"giri",55000),(105,"somu",50000);
insert into Exam_branch values (01,"paid",0,35),(02,"paid",0,35),(03,"pending",3,32),(04,"paid",0,34),(05,"paid",0,35);
insert into Student values (2,"deep",4,200,2),(3,"uday",4,200,3),(4,"srikar",4,201,4);
insert into Student values (5,"bhargavi",3,203,2),(6,"sahithi",3,203,3);




--print count of student witn no fee due 
select count(eb.fee_status) from Student as s join Exam_branch as eb on s.exam_id=eb.exam_id where eb.fee_status="paid";1.

2.
--total students who have not paid the fee
select count(eb.fee_status) from Student as s join Exam_branch as eb on s.exam_id=eb.exam_id where eb.fee_status="pending";



3.
--print the student name along wit their hod name
select s.name as student_name ,hod.hod_name as Head_of_the_department from student as s join  Department as d on  s.dept_id=d.dept_id join Head_of_department as hod on d.hod_id=hod.hod_id;

4.
--print the names of student who are currently in 4th year 
select name from Student where currentyear=4; 

5.--print the names of student who are currently in 3th year  with no due fee
select Student.name, Exam_branch.fee_status from Student join Exam_branch on 
Student.exam_id=Exam_branch.exam_id where Student.currentyear=3 and Exam_branch.fee_status="paid" ;
6.
--print the names of student who are currently in 4th year  with no due fee 
--with due exams
select Student.name, Exam_branch.fee_status from Student join Exam_branch on 
Student.exam_id=Exam_branch.exam_id where Student.currentyear=4 and Exam_branch.due_exams>0 and Exam_branch.fee_status="paid" ;

7.
--print the names of student who are currently in 4th and same branch eg 1
select Student.name,  Department.branch from Student join Exam_branch on 
Student.exam_id=Exam_branch.exam_id join Department on Student.dept_id=Department.dept_id  where Student.currentyear=4 and Department.branch=1;

8.
--print the names of student with max salaried hod 
select name ,hod_name ,hod_salary from Student as s join Department as d on s.dept_id=d.dept_id join Head_of_department as hod on d.hod_id=hod.hod_id order by  hod.hod_salary desc  limit 0,1;

9.--print the sum of salaries of hods
select sum(hod_salary) from Student as s join Department as d on s.dept_id=d.dept_id join Head_of_department as hod on d.hod_id=hod.hod_id ;

--print the avg of salaries of hods
select avg(hod_salary) from Student as s join Department as d on s.dept_id=d.dept_id join Head_of_department as hod on d.hod_id=hod.hod_id ;
